<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Electron学习笔记, Java,Flink,高级项目管理,Electron.js等">
    <meta name="description" content="Electron学习笔记

[TOC]
0.序言桌面客户端框架技术选型
作为客户端的架构选型主要面临以下几个方面的需求：

1.开发速度快，能够快速迭代，快速试错
2.客户端能够跨平台，同时适应Windows和Mac平台
3.用户界面友好，">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	 <!- 图床 -->
	<meta name="referrer" content="no-referrer" />
	<!- 统计 -->
	<meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Electron学习笔记 | 梓妤</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="梓妤" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">梓妤</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">梓妤</div>
        <div class="logo-desc">
            
            一个不懂生活的程序猿
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://www.electronjs.org/zh/assets/img/logo.svg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Electron学习笔记</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E5%89%8D%E7%AB%AF/">
                                <span class="chip bg-color">前端</span>
                            </a>
                        
                            <a href="/tags/Electron/">
                                <span class="chip bg-color">Electron</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E5%AD%A6%E4%B9%A0/" class="post-category">
                                学习
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-12-05
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2021-12-14
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    13k
                </div>
                

                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p><strong>Electron学习笔记</strong></p>
<hr>
<p>[TOC]</p>
<h2><span id="0序言"><strong>0.序言</strong></span></h2><p><strong>桌面客户端框架技术选型</strong></p>
<p>作为客户端的架构选型主要面临以下几个方面的需求：</p>
<ul>
<li>1.开发速度快，能够快速迭代，快速试错</li>
<li>2.客户端能够跨平台，同时适应Windows和Mac平台</li>
<li>3.用户界面友好，满足用户对界面的苛求</li>
<li>4.能够与快速与第三方的C++应用、Web应用集成</li>
<li>5.客户端安装包大小适中，减少用户的下载和安装时间</li>
<li>6.支持XP系统(国内还有近10%的用户是XP系统)</li>
<li>7.最大化利用公司现有的开发人员，减少因为技术选型引起的大规模人员变动</li>
</ul>
<p>客户端的开发技术/框架，主要以下有几种：</p>
<ol>
<li>纯Native开发, C++/C#/duilib+C++(Windows), Objective-c(Mac)</li>
<li>Qt(Windows/Mac)</li>
<li>NW.js/Electron(Windows/Mac)</li>
<li>CEF(Windows/Mac)</li>
</ol>
<p>分析几种开发技术/框架适用的场景和优缺点<br><strong>1.Native开发</strong></p>
<p>在桌面客户端开发中，纯Native开发是一直沿用至今，也是使用最多的技术。使用Native开发，能够实现最好的性能，可以比较容易的与第三方的C++应用集成。</p>
<p>优点：</p>
<p>•客户端性能比较好</p>
<p>•安装包比较小</p>
<p>•Windows比较容易兼容XP</p>
<p>缺点：</p>
<p>•界面开发复杂，开发周期长，无法实现快速迭代</p>
<p>•跨平台开发困难，需要针对Windows和Mac分别开发，人员投入大，后期维护困难</p>
<p>纯Native开发的优缺点，使得其适用于客户端性能要求高、界面简单、客户端安装包小、开发人员富足等场景。</p>
<hr>
<p><strong>2.Qt开发</strong></p>
<p>一直以来被许多用户作为跨平台客户端开发的首选，其功能强大、支持的操作系统丰富、与C++结合紧密，其在某些特定领域(如嵌入式领域、军工、安防监控领域等)非常受欢迎。<br><img src="https://img-blog.csdnimg.cn/20200410223919109.jpg" alt="在这里插入图片描述"><br>优点：</p>
<p>•支持的操作系统丰富、跨平台性好</p>
<p>•性能比较好，接近纯Native开发的性能</p>
<p>•功能丰富、具有各种成熟类库</p>
<p>缺点：</p>
<p>•Qt开发人员不足，市场上Qt的开发人员一直都很少</p>
<p>•库太大，导致安装包也会过大</p>
<p>•Qt学习成本高，需要花费很多的时间和成本才能达到熟练开发的程度</p>
<p>•界面开发效率不高，满足不了互联网快发迭代的要求</p>
<p>•Qt使用GPL授权协议，需要商业授权协议才能做商业应用</p>
<p>从使用的情况来看，Qt作为跨平台的桌面端开发框架，有其有力的方面，但缺点也制约了其快速发展和在客户端开发的大规模使用。</p>
<hr>
<p><strong>3.NW.js/Electron</strong></p>
<p>随着PC机不断提升的机器性能以及H5标准的发展，利用JS语言依靠Browser为载体的B/S体系软件，有着很强的交互表现力，使用Html/JS作为UI的开发语言，可以十分高效快速的完成各种复杂界面（尤其是各种动画效果）开发。</p>
<p>随着Nodejs和Chromium的CEF越来越成熟，出现了将Nodejs与Webkit集成的开源框架，比较成熟的有NW.js(前身node-webkit)和Electron(前身atom-shell), 该类型的框架既能使用Html/JS来开发UI界面，又能集成C++库来完成大计算量的任务，使得开发基于Web和Native混合的应用非常方便。<br><img src="https://img-blog.csdnimg.cn/20200410224119883.jpg" alt="在这里插入图片描述"></p>
<p>NW.js和Electron相比，各有优缺点，对比如下表：<br><img src="https://img-blog.csdnimg.cn/20200410224138619.jpg" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20200410224202626.jpg" alt="在这里插入图片描述"></p>
<p>由于集成了Node.js和Webkit，以及丰富的Node.js第三方库，NW.js和Electron提供了完全使用Javascript来开发客户端的能力。只要熟悉前端Web开发，就能迅速开发出与传统客户端相媲美的客户端软件，开发速度和功能都能满足目前互联网时代的要求，大家的前端开发人员储备，海量的Web 框架和UI组件，使得它们成为了目前最炙手可热的客户端开发框架。</p>
<p><strong>Electron和NW.js相比较来说，Electron的发展更快、bug更少、贡献者更多、社区更活跃</strong>。参考知乎上的某篇问答： 维护一个大型开源项目是怎样的体验？ - zcbenz 的回答 ，根据NW和Electron的作者自己的回答，显然Electron比NW.js更好。<strong>如果不考虑支持XP系统，Electron更适合作为客户端的框架。</strong></p>
<p><img src="https://img-blog.csdnimg.cn/20200410224225704.jpg" alt="在这里插入图片描述"></p>
<p>优点：</p>
<p>•跨平台性好，可以同时支持Windows、Mac和Linux</p>
<p>•开发速度快，能够快速构建产品推向市场</p>
<p>•前端人员储备丰富，招聘开发人员容易</p>
<p>•框架开源，升级比较快</p>
<p>从开发桌面客户端的便捷性、跨平台性等来看，NW.js和Electron几乎满足互联网时代的客户端架构需求，但它们也存在一些不足。</p>
<p>•Electron支持的最低Windows版本是Windows 7， 当开发的产品需要支持XP系统时，只能选用NW.js</p>
<p>•NW.js和Electron对透明窗口支持不好，NW.js支持Vista、Electron支持Windows 7以上的系统，并且必须在DWM(Desktop Window Manager)打开的时候才能实现透明窗口，NW.js和Electron的透明窗口无法调整大小，Electron在Mac上，透明窗口的阴影显示不出来</p>
<p>•由于集成了Webkit浏览器，客户端安装包过大</p>
<p><strong>不考虑实现透明窗口，Nw.js和Electron是目前桌面客户端跨平台方案中最廉价和最通用的方案，因此，在做客户端框架选型时，可以优先考虑NW.js和Electron。</strong></p>
<p><img src="https://img-blog.csdnimg.cn/20200410224245968.jpg" alt="在这里插入图片描述"></p>
<hr>
<p><strong>4.CEF</strong></p>
<p>Chromium Embedded Framework (CEF)是个基于Google Chromium项目的开源Web browser控件（俗称谷歌亲儿子），支持Windows, Linux, Mac平台， 其包含C/C++程序接口，能够完美的与C++库集成，完善的支持Html5 Web页面开发，并且可以通过修改编译选项和源代码后编译的方式来实现剪裁CEF和提供原CEF没有的功能，定制自己的窗口类型。</p>
<p>优点：</p>
<p>•CEF可以通过编译和修改源代码的方式来定制</p>
<p>•可以通过C++控制窗口类型，支持透明窗口</p>
<p>•能够使用最新的CEF来兼容最新的Javascript标准和CSS，或者固定CEF的版本来支持Windows XP</p>
<p>•底层与C++集成容易</p>
<p>•可以使用Javascript来开发UI，C++实现大计算量的任务</p>
<p>缺点：</p>
<p>•与操作系统相关的功能，如读取注册表、写文件等功能，需要C++实现，增加了一些C++开发的工作量</p>
<p>•不经过裁剪的CEF，安装包会过大</p>
<p>对于要实现透明窗口和集成大量的C++模块的应用，CEF是个不错的选择。</p>
<p><img src="https://img-blog.csdnimg.cn/20200410224306175.jpg" alt="在这里插入图片描述"></p>
<p><em><strong>结论</strong></em></p>
<p>在互联网时代，选择一个合适的客户端框架，对于一个产品快速的推向市场，有着至关重要的作用。<strong>NW.js、Electron、CEF等Web brower模式的开发框架，能够完美复用现有的Web开发框架和技术，极大的提高开发速度，实现产品的快速迭代、最终实现产品的成功。</strong></p>
<h2><span id="1electron简介"><strong>1.Electron简介</strong></span></h2><p> 官网地址</p>
<p><a target="_blank" rel="noopener" href="https://www.electronjs.org/">https://www.electronjs.org/</a></p>
<h3><span id="electron是什么"></span></h3><p>Electron是一个使用 JavaScript、HTML 和 CSS 构建桌面应用程序的框架。 嵌入 <a target="_blank" rel="noopener" href="https://www.chromium.org/">Chromium</a> 和 <a target="_blank" rel="noopener" href="https://nodejs.org/">Node.js</a> 到 二进制的 Electron 允许您保持一个 JavaScript 代码代码库并创建 在Windows上运行的跨平台应用 macOS和Linux——不需要本地开发 经验。</p>
<p>你只要记住下面这两句话就可以对Electron有个基本了解：</p>
<ul>
<li>Electron 是由 Github开发的开源框架</li>
<li>它允许开发者使用Web技术构建跨平台的桌面应用</li>
</ul>
<blockquote>
<p>Electron = Chromium + Node.js + Native API</p>
</blockquote>
<ul>
<li>Chromium : 为Electron提供了强大的UI能力，可以不考虑兼容性的情况下，利用强大的Web生态来开发界面。</li>
<li>Node.js ：让Electron有了底层的操作能力，比如文件的读写，甚至是集成C++等等操作，并可以使用大量开源的<code>npm</code>包来完成开发需求。</li>
<li>Native API ： Native API让Electron有了跨平台和桌面端的原生能力，比如说它有统一的原生界面，窗口、托盘这些。</li>
</ul>
<p>通过三者的巧妙组合，我们开发应用变的十分高效。</p>
<h3><span id="前提条件"></span></h3><p>熟悉该文档之前，需要你有Node.js和web开发经验。 如果您需要了解这两个方面的开发知识，我们推荐您使用以下学习资源：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web">来自Mozilla开发社区(Mozilla Developer Network)的web入门教程</a></li>
<li><a target="_blank" rel="noopener" href="https://nodejs.dev/learn">NodeJS官方入门指南</a></li>
</ul>
<p>此外，如果您熟悉Chromium进程模型，您将更好了解 Electron 的工作原理。 You can get a brief overview of Chrome architecture with the <a target="_blank" rel="noopener" href="https://www.google.com/googlebooks/chrome/">Chrome comic</a>, which was released alongside Chrome’s launch back in 2008. 尽管Chrome发布十多年了，【Chrome comic】漫画中介绍的核心原理仍然有助于理解Electron。</p>
<h3><span id="electron-fiddle运行实例"></span></h3><p><a target="_blank" rel="noopener" href="https://electronjs.org/fiddle">Electron Fiddle</a>是由Electron开发并由其维护者支持的沙盒程序。 我们强烈建议将其作为一个学习工具来安装，以便在开发过程中对Electron的api进行实验或对特性进行原型化。</p>
<p>Fiddle also integrates nicely with our documentation. When browsing through examples in our tutorials, you’ll frequently see an “Open in Electron Fiddle” button underneath a code block. If you have Fiddle installed, this button will open a <code>fiddle.electronjs.org</code> link that will automatically load the example into Fiddle, no copy-pasting required.</p>
<h3><span id="什么时候使用electron"></span></h3><ol>
<li>公司没有专门的桌面应用开发者，而需要前端兼顾来进行开发时，用Electron就是一个不错的选择。</li>
<li>一个应用同时开发Web端和桌面端的时候，那使用Electron来进行开发就对了。</li>
<li>开发一些效率工具，比如说我们的VSCode，比如说一些API类的工具，用Electron都是不错的选择。</li>
</ol>
<h3><span id="有哪些著名应用是用electron开发的"></span></h3><ul>
<li>VSCode ： 程序员最常用的开发者工具。</li>
<li>Atom : 是Github开发的文本编辑器，我想大部分的前端程序员都应该使用过。</li>
<li>slack ： 聊天群组 + 大规模工具集成 + 文件整合 + 搜索的一个工具。就是把很多你常用的工具整合到了一起。</li>
<li>wordPress ： 基于PHP开发的Blog搭建工具，新版本使用了Electron.</li>
</ul>
<h2><span id="2electron原理"><strong>2.Electron原理</strong></span></h2><p>简单来说，Electron为用纯JavaScript创建桌面应用提供了运行时。原理是，Electron调用你在package.json中定义的main文件并执行它。main文件（通常被命名为main.js）会创建一个内含渲染完的web页面的应用窗口，并添加与你操作系统的原生GUI（图形界面）交互的功能。</p>
<p>详细地说，当用Electron启动一个应用，会创建一个主进程。这个主进程负责与你系统原生的GUI进行交互并为你的应用创建GUI（在你的应用窗口）。</p>
<p><img src="/2021/12/05/electron-xue-xi-bi-ji/Typora文档\images\image-20210717144328954.png" alt="image-20210717144328954"></p>
<p>仅启动主进程并不能给你的应用用户创建应用窗口。窗口是通过main文件里的主进程调用叫BrowserWindow的模块创建的。每个浏览器窗口会运行自己的渲染进程。渲染进程会在窗口中渲染出web页面（引用了CSS，JavaScript，图片等的HTML文件）。web页面是<a target="_blank" rel="noopener" href="https://www.chromium.org/">Chromium</a>渲染的，因为各系统下标准是统一的的，所以兼容性很好。</p>
<p>举例来说，如果你有一个计算器应用，主进程会初始化一个窗口来呈现实际的web页面（计算器）。虽说只有主进程才和系统原生GUI交互，还是有技术可以把部分任务转到渲染进程中运行。</p>
<p>主进程通过一套<a target="_blank" rel="noopener" href="https://github.com/atom/electron/tree/master/docs/api">可直接调用的Electron模块</a>与原生GUI交互，桌面应用可以使用所有的Node模块，如用<a target="_blank" rel="noopener" href="https://github.com/mikaelbr/node-notifier">node-notifier模块</a>来推送系统通知，<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/request">request模块</a>来发起HTTP请求等。</p>
<h2><span id="3electron开发环境搭建"><strong>3.Electron开发环境搭建</strong></span></h2><h3><span id="windows下安装nodejs"></span></h3><p>如果你是前端，安装Node应该是信手拈来，非常熟悉了，但是为了防止有小伙伴还不会安装这个，我简单的介绍一下.</p>
<blockquote>
<p>Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。什么事情驱动、非阻塞式I/O，适合高并发应用使用。</p>
</blockquote>
<p>Windows下安装也是非常简单，直接到官网去下载。</p>
<blockquote>
<p>官网地址：<a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/">https://nodejs.org/zh-cn/</a></p>
</blockquote>
<p>然后点击下载，选择长期支持版本，我这时的版本是12.14.1.</p>
<ul>
<li>长期支持版本：就是已经文档了，并且会一直维护下去的版本，比如有个小Bug啥的，官方会马上进行修复。</li>
<li>最新版本： 有很多功能，但是也会同时存在很多Bug或者说坑，如果你是个人学习，完全可以使用最新发布版，但是如果是公司，你还是尽量使用长期支持版本。</li>
</ul>
<p>点击下载后，安装过程和安装QQ基本一样，下一步、下一步，我就不作过多的介绍了。实在不会，你百度一下，有很多文章会教你如何安装Node。</p>
<p>安装后，可以使用下面两个命令进行检测，如果可以梳理出现邦本，说明你安装成功了。</p>
<ul>
<li>npm -v</li>
<li>node -v</li>
</ul>
<p>如果成功会出现当前的版本，最好使用<code>v10</code>以上版本。</p>
<h3><span id="electron安装">electron安装</span></h3><p>在命令行中输入以下命令，即可安装electron，使用淘宝NPM开发的cnpm进行package的安装</p>
<p>cnpm install -g electron</p>
<p>等待安装完成之后，在命令行输入<code>electron -v</code>能够显示版本号代表安装成功。</p>
<p>如果想删除 Electron，可以使用下面的命令。npm uninstall electron<br>如果想升级 Electron，则可以使用这个命令。npm update electron -g</p>
<p>直接执行 electron 命令，会显示如下图所示的窗口，该窗口包含了与 Electron 相关的信息，如 Electron 的版本号、Node.js 的版本号、API Demo 的下载链接等。<br><img src="/2021/12/05/electron-xue-xi-bi-ji/Typora文档\images\image-20210717214235191.png" alt="image-20210717214235191"></p>
<p>在你喜欢的盘符下，建立一个文件夹，这个文件可以是任何名字。然后用VSCode进行打开。打开终端，直接在终端中输入安装命令：</p>
<pre><code>npm install electron --save-dev
</code></pre>
<p>然后就是耐心的等待，这个等待时间还是比较长的，等待全部完成后，可以使用下面两个命令进行检验。</p>
<pre><code>npx electron -v
./node_modules/.bin/electron -v
F:\technology\Electron\demo\node_modules\.bin&gt; .\electron.cmd -v
</code></pre>
<p>如果安装成功，这两个命令都可以出现版本。</p>
<p>如果你还不放心，你可以直接在命令行启动一下Electron，如果能顺利启动，并出现这个图，说明你安装成功了。</p>
<pre><code>//启动命令
./node_modules/.bin/electron
</code></pre>
<p><img src="http://newimg.jspang.com/ElectronDemo2.png" alt="ElectronUI"></p>
<h2><span id="4electron-hello-world"><strong>4.Electron Hello World</strong></span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc312">全局安装Electron</a></p>
<pre><code>npm install -g electron
</code></pre>
<p>这个如果安装失败，你可以多安装两遍，你也可以使用cnpm来进行安装。安装后确实可以使用起来方便一点。</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc313">新建index.html文件</a></p>
<p>新建一个文件夹，比如叫<code>ElectronDemo01</code>.</p>
<p>在项目的根目录中新建一个<code>index.html</code>文件，然后编写如下的代码(可以用快速生成的方式来写这段代码)。</p>
<pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    Hello World!
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc314">新建main.js文件</a></p>
<p>在根目录下新建一个<code>main.js</code>文件，这个就是Electron的主进程文件。</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> electron <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//引入electron模块</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> electron<span class="token punctuation">.</span>app   <span class="token comment" spellcheck="true">// 创建electron引用</span>

<span class="token keyword">var</span> BrowserWindow <span class="token operator">=</span> electron<span class="token punctuation">.</span>BrowserWindow<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//创建窗口引用</span>

<span class="token keyword">var</span> mainWindow <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//声明要打开的主窗口</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
    mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>width<span class="token punctuation">:</span><span class="token number">400</span><span class="token punctuation">,</span>height<span class="token punctuation">:</span><span class="token number">400</span><span class="token punctuation">}</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">//设置打开的窗口大小</span>

    mainWindow<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//加载那个页面</span>

    <span class="token comment" spellcheck="true">//监听关闭事件，把主窗口设置为null</span>
    mainWindow<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'closed'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
        mainWindow <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc315">创建package.json文件</a></p>
<p>写完后直接使用<code>npm init --yes</code>来初始化<code>package.json</code>文件，文件生成后如下：</p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>
  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"ElectronDemo1"</span><span class="token punctuation">,</span>
  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token string">"main"</span><span class="token punctuation">:</span> <span class="token string">"main.js"</span><span class="token punctuation">,</span>
  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"test"</span><span class="token punctuation">:</span> <span class="token string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"keywords"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token string">"license"</span><span class="token punctuation">:</span> <span class="token string">"ISC"</span>
<span class="token punctuation">}</span>
</code></pre>
<p>这时候<code>main</code>的值为<code>main.js</code>就正确了。</p>
<p>这时候你就可以打开终端，在终端里输入<code>electron .</code>就可以打开窗口了。</p>
<p>(windows系统) 注意后面的.</p>
<pre><code>electron.cmd  .
</code></pre>
<h2><span id="5electron编写邀请小姐姐程序">5.Electron编写邀请小姐姐程序</span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc317">Electron的运行流程</a></p>
<p><img src="http://newimg.jspang.com/electrondemo1.png" alt="electron"></p>
<ul>
<li>1.读取package.json的中的入口文件,这里我们是<code>main.js</code></li>
<li>2.main.js 主进程中创建渲染进程</li>
<li>3.读取应用页面的布局和样式</li>
<li>4.使用IPC在主进程执行任务并获取信息</li>
</ul>
<p>也许你现在还不能理解这个流程,但是你需要记住这个流程,只有我们记住这个流程后,在以后程序出现问题时,才可以很快的定位问题.</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc318">Electron的主进程和渲染进程</a></p>
<p>我们可以理解<code>package.json</code>中定义的入口文件就是主进程,那一般一个程序只有一个主进程,而我们可以利用一个主进程,打开多个子窗口.</p>
<p>由于 Electron 使用了 Chromium 来展示 web 页面，所以 Chromium 的多进程架构也被使用到。 每个 Electron 中的 web 页面运行在它自己的渲染进程中,也就是我们说的渲染进程.</p>
<p>也就是说主进程控制渲染进程,一个主进程可以控制多个渲染进程.</p>
<p><img src="http://newimg.jspang.com/electronDemo08.png" alt="electron流程图"></p>
<p>如果你实在不理解,也没关系,你可以简单的把main.js看成主进程,我们写的html部分看成渲染进程.虽然这样不太严谨,但是方便我们记忆,我们目的是学会使用Electron,而不是成为Electron的专家.</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc319">简单示例-读取小姐姐</a></p>
<p>在我们了解主进程和渲染进程后,我们来作一个读取小姐姐案例.现在项目根目录下建立一个<code>xiaojiejie.txt</code>的文件,然后写入几个小姐姐的名字.</p>
<p>代码如下:</p>
<pre class=" language-js"><code class="language-js"><span class="token number">1</span><span class="token punctuation">.</span>麻里梨夏
<span class="token number">2</span><span class="token punctuation">.</span>星野娜美
<span class="token number">3</span><span class="token punctuation">.</span>高桥圣子
</code></pre>
<p>有了这个文件,我们修改一下main.js文件,因为我们要使用node里的<code>fs</code>模块,所以在设置窗口时,增加全量使用node.js.</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> electron <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span> 

<span class="token keyword">var</span> app <span class="token operator">=</span> electron<span class="token punctuation">.</span>app   

<span class="token keyword">var</span> BrowserWindow <span class="token operator">=</span> electron<span class="token punctuation">.</span>BrowserWindow<span class="token punctuation">;</span>

<span class="token keyword">var</span> mainWindow <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
    mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        width<span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">,</span>
        height<span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">,</span>
        webPreferences<span class="token punctuation">:</span><span class="token punctuation">{</span> 
            nodeIntegration<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
            enableRemoteModule<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">//新版本需要增加</span>
               contextIsolation<span class="token punctuation">:</span> <span class="token boolean">false</span>    <span class="token comment" spellcheck="true">//新版本需要增加</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    mainWindow<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>

    mainWindow<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'closed'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
        mainWindow <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>修改完主进程,然后我们到<code>index.html</code>里边写一下界面.这里我们写了一个按钮,然后在按钮下方加一个<code>&lt;div&gt;</code>,这个DIV用来作读取过来内容的容器.</p>
<pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, idivnitial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>小姐姐请进来<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mybaby<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
<p>有了界面之后,我们可以单独新建一个<code>renderer</code>文件夹,一般约定俗成都会起这个名字.注意起这个名字意思是渲染进程中的操作. 文件夹建立完成后,在文件里新建<code>index.js</code>文件,然后再index.html页面里先进行引入.</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>renderer/index.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>然后编写<code>index.js</code>里的代码,代码如下,具体含义我会在视频中进行讲解.</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
window<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> btn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#btn'</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> mybaby <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#mybaby'</span><span class="token punctuation">)</span>
    btn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'xiaojiejie.txt'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
            mybaby<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> data
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre>
<p>写完这些,就可以在中台使用<code>electron .</code> 命令,跳出我们的界面,点击按钮,就可以看到我们的小姐姐进入了界面中.</p>
<p>==排坑==</p>
<p>新版本的electron解决 electron require()报错：Uncaught ReferenceError: require is not defined</p>
<p>主要是设置web属性：</p>
<pre class=" language-c"><code class="language-c">     nodeIntegration<span class="token punctuation">:</span> true<span class="token punctuation">,</span>
    enableRemoteModule<span class="token punctuation">:</span> true<span class="token punctuation">,</span>
    contextIsolation<span class="token punctuation">:</span> false
</code></pre>
<h2><span id="6electron-remote模块的使用">6.Electron Remote模块的使用</span></h2><p>当我们知道了Electron有主进程和渲染进程后，我们还要知道一件事，就是Electron的API方法和模块也是分为可以在主进程和渲染进程中使用。那如果我们想在渲染进程中使用主进程中的模块方法时，可以使用<code>Electron Remote</code>解决在渲染和主进程间的通讯。这节我们就实现一个通过Web中的按钮打开新窗口。</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc321">渲染进程中打开新窗口</a></p>
<p>那我们话不多说，直接按照上节课的程序进行改写,在项目根目录下，新建一个<code>demo2.html</code>文件，然后快速生成html的基本结构，编写一个按钮，引入渲染的js页面。代码如下：</p>
<pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>打开新的窗口<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>renderer/demo2.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
<p>在<code>render</code>文件夹下，新建一个<code>demo2.js</code>文件，然后编写如下代码。</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> btn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#btn'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> BrowserWindow <span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>remote<span class="token punctuation">.</span>BrowserWindow

window<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    btn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>

         newWin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
             width<span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">,</span>
             height<span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">,</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span>
         newWin<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'yellow.html'</span><span class="token punctuation">)</span>
         newWin<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>win<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>这时候还没有<code>yellow.html</code>，在项目根目录下建立页面，然后写入下面的代码。</p>
<pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>utf-8<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>X-UA-Compatible<span class="token punctuation">'</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>IE<span class="token punctuation">=</span>edge<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    yellow
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
<p>然后我们在终端中运行<code>electron .</code>,如果一切正常，就可以顺利打开一个新的窗口，这个窗口可以顺利打开主要的功劳就是<code>electron remote</code>。它让我们有了很多pc端的原生能力。</p>
<h2><span id="7electron创建菜单和基本使用">7.Electron创建菜单和基本使用</span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc323">编写菜单模板</a></p>
<p>在<code>Electron</code>中编写菜单，需要先建立一个模板，这个目标很类似我们<code>JSON</code>或者类的数组。</p>
<p>我们打开项目，在项目的根目录下新建一个文件夹<code>main</code>，意思是主进程中用到的代码我们都写到这里。</p>
<p>然后新建一个<code>menu.js</code>文件,然后编写如下代码。</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> Menu <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> template <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span><span class="token string">'凤来怡洗浴会所'</span><span class="token punctuation">,</span>
        submenu<span class="token punctuation">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>label<span class="token punctuation">:</span><span class="token string">'精品SPA'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>label<span class="token punctuation">:</span><span class="token string">'泰式按摩'</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span><span class="token string">'大浪淘沙洗浴中心'</span><span class="token punctuation">,</span>
        submenu<span class="token punctuation">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>label<span class="token punctuation">:</span><span class="token string">'牛奶玫瑰浴'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>label<span class="token punctuation">:</span><span class="token string">'爱情拍拍手'</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

<span class="token keyword">var</span> m <span class="token operator">=</span> Menu<span class="token punctuation">.</span><span class="token function">buildFromTemplate</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span>

Menu<span class="token punctuation">.</span><span class="token function">setApplicationMenu</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
</code></pre>
<p>然后再打开<strong>主进程<code>main.js</code>文件</strong>，在<code>ready</code>生命周期中，直接加入下面的代码，就可以实现自定义菜单了。</p>
<pre class=" language-js"><code class="language-js"> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./main/menu.js'</span><span class="token punctuation">)</span>
</code></pre>
<p>==需要注意的是，<code>Menu</code>属于是主线程下的模块，所以只能在主线程中使用，这个要记清楚。==</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc324">使用菜单打开新窗口</a></p>
<p>有了菜单之后，可以在菜单中加入<code>click</code>事件，代码如下:</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> Menu <span class="token punctuation">,</span>BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>


<span class="token keyword">var</span> template <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span><span class="token string">'凤来怡洗浴会所'</span><span class="token punctuation">,</span>
        submenu<span class="token punctuation">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                label<span class="token punctuation">:</span><span class="token string">'精品SPA'</span><span class="token punctuation">,</span>
                <span class="token comment" spellcheck="true">//主要代码--------------start</span>
                click<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
                    win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        width<span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">,</span>
                        height<span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">,</span>
                        webPreferences<span class="token punctuation">:</span><span class="token punctuation">{</span> nodeIntegration<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    win<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'yellow.html'</span><span class="token punctuation">)</span>
                    win<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'closed'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
                        win <span class="token operator">=</span> <span class="token keyword">null</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>

                <span class="token punctuation">}</span>
                <span class="token comment" spellcheck="true">//主要代码----------------end</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>label<span class="token punctuation">:</span><span class="token string">'泰式按摩'</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span><span class="token string">'大浪淘沙洗浴中心'</span><span class="token punctuation">,</span>
        submenu<span class="token punctuation">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>label<span class="token punctuation">:</span><span class="token string">'牛奶玫瑰浴'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>label<span class="token punctuation">:</span><span class="token string">'爱情拍拍手'</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

<span class="token keyword">var</span> m <span class="token operator">=</span> Menu<span class="token punctuation">.</span><span class="token function">buildFromTemplate</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span>

Menu<span class="token punctuation">.</span><span class="token function">setApplicationMenu</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
</code></pre>
<p>这时候我们打开终端输入<code>electron .</code>之后，就可以看到效果了，当然我们还可以绑定快捷键。</p>
<h2><span id="8electron制作右键菜单">8.Electron制作右键菜单</span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc326">菜单快捷键绑定</a></p>
<p>绑定快捷键的属性是<code>accelerator</code>属性，比如我们新打开一个窗口，我们就的代码可以写成这样。</p>
<pre class=" language-js"><code class="language-js">accelerator<span class="token punctuation">:</span><span class="token template-string"><span class="token string">`ctrl+n`</span></span>
</code></pre>
<p>全部代码如下：</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> Menu <span class="token punctuation">,</span>BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> template <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span><span class="token string">'凤来怡洗浴会所'</span><span class="token punctuation">,</span>
        submenu<span class="token punctuation">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                label<span class="token punctuation">:</span><span class="token string">'精品SPA'</span><span class="token punctuation">,</span>
                accelerator<span class="token punctuation">:</span><span class="token template-string"><span class="token string">`ctrl+n`</span></span><span class="token punctuation">,</span>
                click<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
                    win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        width<span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">,</span>
                        height<span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">,</span>
                        webPreferences<span class="token punctuation">:</span><span class="token punctuation">{</span> nodeIntegration<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    win<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'yellow.html'</span><span class="token punctuation">)</span>
                    win<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'closed'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
                        win <span class="token operator">=</span> <span class="token keyword">null</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>

                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>label<span class="token punctuation">:</span><span class="token string">'泰式按摩'</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span><span class="token string">'大浪淘沙洗浴中心'</span><span class="token punctuation">,</span>
        submenu<span class="token punctuation">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>label<span class="token punctuation">:</span><span class="token string">'牛奶玫瑰浴'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>label<span class="token punctuation">:</span><span class="token string">'爱情拍拍手'</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>chengxu
<span class="token punctuation">]</span>
<span class="token keyword">var</span> m <span class="token operator">=</span> Menu<span class="token punctuation">.</span><span class="token function">buildFromTemplate</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span>
Menu<span class="token punctuation">.</span><span class="token function">setApplicationMenu</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
</code></pre>
<p>写完代码后，在终端中输入<code>electron .</code> 运行程序，再用快捷键<code>ctrl+n</code>就可以新建一个页面了。这就实现了新建页面的方法。</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc327">创建右键菜单</a></p>
<p>右键菜单的响应事件是写在渲染进程中的，也就是写在<code>menu.html</code>中的，所以要是使用，就用到到<code>remote</code>模块进行操作了。</p>
<p>先来看看右键的相应事件，我们打开<code>render</code>文件夹，然后打开<code>rightmenu.js</code>文件，编写一个右键菜单的监听事件，代码如下：</p>
<pre class=" language-js"><code class="language-js">window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'contextmenu'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>当我们要使用<code>Menu</code>模块,它是主线中的模块，**如果想在渲染线程中使用，就必须使用<code>remote</code>**。代码如下：</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> remote<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> rigthTemplate <span class="token operator">=</span> <span class="token punctuation">[</span>
     <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span><span class="token string">'粘贴'</span><span class="token punctuation">,</span>
        accelerator<span class="token punctuation">:</span><span class="token template-string"><span class="token string">`ctrl+v`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span><span class="token string">'复制'</span><span class="token punctuation">,</span>
        accelerator<span class="token punctuation">:</span><span class="token template-string"><span class="token string">`ctrl+c`</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

<span class="token keyword">var</span> m <span class="token operator">=</span> remote<span class="token punctuation">.</span>Menu<span class="token punctuation">.</span><span class="token function">buildFromTemplate</span><span class="token punctuation">(</span>rigthTemplate<span class="token punctuation">)</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'contextmenu'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">//阻止当前窗口默认事件</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//把菜单模板添加到右键菜单</span>
    m<span class="token punctuation">.</span><span class="token function">popup</span><span class="token punctuation">(</span><span class="token punctuation">{</span>window<span class="token punctuation">:</span>remote<span class="token punctuation">.</span><span class="token function">getCurrentWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>现在就可以有右键菜单了，我们可以在终端中输入<code>electron .</code>打开程序进行测试。</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc328">程序打开调试模式</a></p>
<p>由于我们已经定义了顶部菜单，没有了打开调试模式的菜单了，这时候可以使用程序来进行打开。在主进程中加入这句代码就可以了。</p>
<pre class=" language-js"><code class="language-js">mainWindow<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">openDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>全部代码如下:</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> electron <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span> 

<span class="token keyword">var</span> app <span class="token operator">=</span> electron<span class="token punctuation">.</span>app   

<span class="token keyword">var</span> BrowserWindow <span class="token operator">=</span> electron<span class="token punctuation">.</span>BrowserWindow<span class="token punctuation">;</span>

<span class="token keyword">var</span> mainWindow <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
    mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        width<span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">,</span>
        height<span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">,</span>
        webPreferences<span class="token punctuation">:</span><span class="token punctuation">{</span> nodeIntegration<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    mainWindow<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">openDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./main/menu.js'</span><span class="token punctuation">)</span>

    mainWindow<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'demo2.html'</span><span class="token punctuation">)</span>

    mainWindow<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'closed'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
        mainWindow <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>这样就实现了打开窗口，直接进入调试模式，极大的提高了调试效率。</p>
<h2><span id="9electron中通过链接打开浏览器">9.Electron中通过链接打开浏览器</span></h2><p>在渲染进程中默认加入一个<code>&lt;a&gt;</code>标签，进行跳转默认是直接在窗口中打开，而不是在浏览器中打开的，如果我们想在默认浏览器中打开，要如何操作呢?</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc330">默认案例演示</a></p>
<p>我们先来看一下，在electron 中默认打开一个链接是什么样的，在项目根目录，新建一个<code>demo2.html</code>文件，编写一个<code>&lt;a&gt;</code>标签，代码如下：</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">></span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1.0"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
<span class="token operator">&lt;</span>body<span class="token operator">></span>
    <span class="token operator">&lt;</span>h1<span class="token operator">></span>
        <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://jspang.com"</span><span class="token operator">></span>技术胖的博客<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span>
</code></pre>
<p>这时候我们运行程序，点击链接以后，可以看到是在窗口中直接打开的，而不是在浏览器中打开。我们现在要作的就是在浏览器中打开。</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc331">使用Shell在浏览器中打开</a></p>
<p>如果想使用浏览器打开，我们可以直接在<code>&lt;a&gt;</code>标签中加入id,代码如下:</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>a id<span class="token operator">=</span><span class="token string">"aHref"</span> href<span class="token operator">=</span><span class="token string">"https://jspang.com"</span><span class="token operator">></span>技术胖的博客<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>
</code></pre>
<p>然后在<code>render</code>文件夹下，新建一个<code>demo3.js</code>文件，先在文件首页中引入<code>shell</code>,然后编写响应事件<code>click</code>。</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token punctuation">{</span> shell <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> aHref <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#aHref'</span><span class="token punctuation">)</span> 

aHref<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> href <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">)</span>
    shell<span class="token punctuation">.</span><span class="token function">openExternal</span><span class="token punctuation">(</span>href<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>编写完成，要记得在<code>html</code>中引入<code>demo3.js</code>文件。</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"./renderer/demo3.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre>
<p>这里给出<code>demo3.html</code>全部代码，方便你的学习。</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">></span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1.0"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
<span class="token operator">&lt;</span>body<span class="token operator">></span>
    <span class="token operator">&lt;</span>h1<span class="token operator">></span>
        <span class="token operator">&lt;</span>a id<span class="token operator">=</span><span class="token string">"aHref"</span> href<span class="token operator">=</span><span class="token string">"https://jspang.com"</span><span class="token operator">></span>技术胖的博客<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>
    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"./renderer/demo3.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span>
</code></pre>
<h2><span id="10electron-中嵌入网页和打开子窗口">10.Electron 中嵌入网页和打开子窗口</span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc333">在主进程中用BrowserView嵌入网页</a></p>
<p>打开根目录下打开<code>main.js</code>,直接引入并使用<code>BrowserView</code>就可以实现键入网页到应用中。</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> BrowserView <span class="token operator">=</span> electron<span class="token punctuation">.</span>BrowserView <span class="token comment" spellcheck="true">//引入BrowserView</span>
<span class="token keyword">var</span> view <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserView</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">//new出对象</span>
mainWindow<span class="token punctuation">.</span><span class="token function">setBrowserView</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">// 在主窗口中设置view可用</span>
view<span class="token punctuation">.</span><span class="token function">setBounds</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>y<span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">,</span>width<span class="token punctuation">:</span><span class="token number">1200</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span><span class="token number">800</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//定义view的具体样式和位置</span>
view<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">'https://jspang.com'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//wiew载入的页面</span>
</code></pre>
<p>这个使用起来非常简单，写完上面的代码，就可以在终端中输入一下<code>electron .</code>，运行程序，测试一下效果了。</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc334">用window.open打开子窗口</a></p>
<p>我们以前使用过<code>BrowserWindow</code>,这个是有区别的，我们通常把<code>window.open</code>打开的窗口叫做子窗口。 在<code>demo3.html</code>中，加入一个按钮，代码如下：</p>
<pre class=" language-js"><code class="language-js"> <span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"mybtn"</span> <span class="token operator">></span>打开子窗口<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span> 
</code></pre>
<p>然后打开<code>demo3.js</code>,先获取<code>button</code>的DOM节点，然后监听onclick事件，代码如下：</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> mybtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#mybtn'</span><span class="token punctuation">)</span>

mybtn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>

    window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'https://jspang.com'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2><span id="11electron-子窗口和父窗口间的通信">11.Electron 子窗口和父窗口间的通信</span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc336">window.opener.postMessage 子窗口向父窗口传递消息</a></p>
<p><code>window.opener.postMessage(message,targetOrigin)</code>,是将消息发送给指定来源的父窗口，如果未指定来源则发送给<code>*</code>，即所有窗口。</p>
<ul>
<li>message : 传递的消息，是<code>String</code>类型的值</li>
<li>targetOrigin : 指定发送的窗口</li>
</ul>
<p>在传递消息时，你需要在子窗口的页面中设置一些内容，所以我们不能使用远程的页面，而需要自己建立一个。在项目根目录，建立一个<code>popup_page.html</code>文件。 代码如下(详细解释在视频中讲解):</p>
<pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>我是弹出子窗口<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>popBtn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>向窗口传递信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> popBtn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#popBtn'</span><span class="token punctuation">)</span>
    popBtn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        window<span class="token punctuation">.</span>opener<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'我是子窗口的消息'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
<p>这样就可以从子窗口向父窗口发送信息了。</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc337">window.addEventListener父窗口接收信息</a></p>
<p>先打开<code>demo3.html</code>,在代码最下面，加一个<code>&lt;div&gt;</code>标签，记得要给一个ID，这样就用JS控制这个层了。</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mytext<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
<p>父窗口接收信息需要通过<code>window.addEventListener</code>,例如现在我们打开<code>demo3.js</code>，也就是父窗口的JS代码部分，写入下面代码：</p>
<pre class=" language-js"><code class="language-js">window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> mytext <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#mytext'</span><span class="token punctuation">)</span>
    mytext<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>这样父窗口就可以顺利接收到子串口发送过来的信息了，也可以轻松的显示在子窗口中。</p>
<h2><span id="12electron选择文件对话框">12.Electron选择文件对话框</span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc339">对话框相关API讲解</a></p>
<p>我们先来看一下打开对话框的相关API，打开文件选择对话框可以使用<code>dialog.showOpenDialog()</code>方法来打开，它有两个参数，一个是设置基本属性，另一个是回调函数，如果是异步可以使用<code>then</code>来实现。</p>
<ul>
<li>title ： String (可选)，对话框的标题</li>
<li>defaultPath ： String (可选),默认打开的路径</li>
<li>buttonLabel ： String (可选), 确认按钮的自定义标签，当为空时，将使用默认标签</li>
<li>filters ： 文件选择过滤器，定义后可以对文件扩展名进行筛选</li>
<li>properties：打开文件的属性，比如打开文件还是打开文件夹，甚至是隐藏文件。</li>
</ul>
<p>对基本的API了解以后，就可以写代码看看具体的效果了。</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc340">选择对话框练习</a></p>
<p>在根目录新建一个<code>demo4.html</code>文件，然后编写一个按钮，点击按钮可以打开窗口选择文件。</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">></span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1.0"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
<span class="token operator">&lt;</span>body<span class="token operator">></span>
    <span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"openBtn"</span><span class="token operator">></span>打开文件<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>

<span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>dialog<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>remote
    <span class="token keyword">var</span> openBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'openBtn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    openBtn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        dialog<span class="token punctuation">.</span><span class="token function">showOpenDialog</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            title<span class="token punctuation">:</span><span class="token string">'请选择你喜欢的小姐姐照片'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>

<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span>
</code></pre>
<p>写完后记得把<code>main.js</code>中的引入页面改成<code>demo4.html</code>代码如下：</p>
<pre class=" language-js"><code class="language-js"> mainWindow<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">"demo4.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>使用<code>electron .</code> 预览一下，可以看到，已经可以顺利打开文件选择窗口了。</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc341">默认路径的设置</a></p>
<p>这时打开的窗口是没有默认文件的，比如我们想直接定位到小姐姐文件<code>xiaojiejie.jpg</code>，就可以用<code>defaultPath</code>来进行制作。 代码如下：</p>
<pre class=" language-js"><code class="language-js">dialog<span class="token punctuation">.</span><span class="token function">showOpenDialog</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token punctuation">:</span><span class="token string">'请选择你喜欢的小姐姐照片'</span><span class="token punctuation">,</span>
    defaultPath<span class="token punctuation">:</span><span class="token string">'xiaojiejie.jpg'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc342">过滤器的使用</a></p>
<p>现在程序还是可以看到很多其他的文件，我们的原则就是想选择一个美女照片，然后显示在界面上，这时候就需要用到过滤器了。</p>
<pre class=" language-js"><code class="language-js">openBtn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    dialog<span class="token punctuation">.</span><span class="token function">showOpenDialog</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        title<span class="token punctuation">:</span><span class="token string">'请选择你喜欢的小姐姐照片'</span><span class="token punctuation">,</span>
        defaultPath<span class="token punctuation">:</span><span class="token string">'xiaojiejie.jpg'</span><span class="token punctuation">,</span>
        filters<span class="token punctuation">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'jpg'</span><span class="token punctuation">,</span>extensions<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'jpg'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc343">自定义确定按钮</a></p>
<p>可以直接使用<code>buttonLabel</code>来自定义确定按钮的文字，比如现在把文字改成’打开图片’。</p>
<pre class=" language-js"><code class="language-js">dialog<span class="token punctuation">.</span><span class="token function">showOpenDialog</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token punctuation">:</span><span class="token string">'请选择你喜欢的小姐姐照片'</span><span class="token punctuation">,</span>
    defaultPath<span class="token punctuation">:</span><span class="token string">'xiaojiejie.jpg'</span><span class="token punctuation">,</span>
    buttonLabel<span class="token punctuation">:</span><span class="token string">'打开图片'</span><span class="token punctuation">,</span>
    filters<span class="token punctuation">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'jpg'</span><span class="token punctuation">,</span>extensions<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'jpg'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc344">把小姐姐放到应用中</a></p>
<p>当我们选择到了一个文件后，<code>showOpenDialog</code>提供了回调函数，也就是我们的第二个参数。现在来看一下回调函数如何获得图片路径。</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">></span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1.0"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
<span class="token operator">&lt;</span>body<span class="token operator">></span>
    <span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"openBtn"</span><span class="token operator">></span>打开文件<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>
    <span class="token operator">&lt;</span>img id<span class="token operator">=</span><span class="token string">"images"</span>  style<span class="token operator">=</span><span class="token string">"width:100%"</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>

<span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>dialog<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>remote
    <span class="token keyword">var</span> openBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'openBtn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    openBtn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        dialog<span class="token punctuation">.</span><span class="token function">showOpenDialog</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            title<span class="token punctuation">:</span><span class="token string">'请选择你喜欢的小姐姐照片'</span><span class="token punctuation">,</span>
            defaultPath<span class="token punctuation">:</span><span class="token string">'xiaojiejie.jpg'</span><span class="token punctuation">,</span>
            filters<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'jpg'</span><span class="token punctuation">,</span>extensions<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'jpg'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>result<span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
            <span class="token keyword">let</span> image <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'images'</span><span class="token punctuation">)</span>
            image<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"src"</span><span class="token punctuation">,</span>result<span class="token punctuation">.</span>filePaths<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>

<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span>
</code></pre>
<p>这样完成了选择照片，并显示在界面上的功能，有的小伙伴这时候就会问了，我用html的选择文件也可以实现这个效果，确实是可以实现的，但我认为既然用了Electron就最好使用原生的形式打开。</p>
<h2><span id="13electron保存对话框的操作">13.Electron保存对话框的操作</span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc346">制作一个保存按钮</a></p>
<p>先在<code>demo4.html</code>中，编写一个按钮：</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"saveBtn"</span><span class="token operator">></span>保存文件<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>
</code></pre>
<p>然后在<code>&lt;script&gt;</code>标签中加入下面的代码,这时候就可以顺利的弹出保存文件对话框了，我们可以随便写一个文件名，然后会在控制台给我们返回出来结果。</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> saveBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'saveBtn'</span><span class="token punctuation">)</span>
    saveBtn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        dialog<span class="token punctuation">.</span><span class="token function">showSaveDialog</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            title<span class="token punctuation">:</span><span class="token string">'保存文件'</span><span class="token punctuation">,</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>result<span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>其实我们还可以作的更多，比如我们引入Node中的<code>fs</code>模块，然后进行文件流的操作，就可以真的生成一个文件。</p>
<p>先引入<code>fs</code>模块。</p>
<pre class=" language-js"><code class="language-js"> <span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
</code></pre>
<p>然后在保存后，向文件里写入内容。</p>
<pre class=" language-js"><code class="language-js">saveBtn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    dialog<span class="token punctuation">.</span><span class="token function">showSaveDialog</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        title<span class="token punctuation">:</span><span class="token string">'保存文件'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>result<span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>filePath<span class="token punctuation">)</span>
        fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>filePath<span class="token punctuation">,</span><span class="token string">'技术胖一个前端爱好者'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>写完这一步就可以在终端中输入<code>electron .</code> 来打开应用，进行预览了。这节课的内容就到这里了，内容不多。</p>
<h2><span id="14electron消息对话框的操作">14.Electron消息对话框的操作</span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc348">showMessageBox 相关属性</a></p>
<p>它有太多的属性，这里我们也只挑一些常用的属性来讲解，如果你在工作中具体使用，可以先到官网查询相关的API后，再根据需求具体使用。</p>
<ul>
<li>type ：String类型，可以选，图标样式，有<code>none</code>、<code>info</code>、<code>error</code>、<code>question</code>和<code>warning</code></li>
<li>title: String类型，弹出框的标题</li>
<li>messsage : String 类型，必选 message box 的内容，这个是必须要写的</li>
<li>buttons: 数组类型，在案例中我会详细的讲解，返回的是一个索引数值（下标）</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc349">制作一个确认对话框</a></p>
<p>先在<code>Demo4.html</code>中增加一个按钮。</p>
<pre class=" language-html"><code class="language-html"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>messageBtn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>弹出对话框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
</code></pre>
<p>然后这个对话框的内容也非常简单，就是简单的弹出一句话，用户可以点击“确定”或者“取消”。代码如下：</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> messageBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'messageBtn'</span><span class="token punctuation">)</span>
    messageBtn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        dialog<span class="token punctuation">.</span><span class="token function">showMessageBox</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            type<span class="token punctuation">:</span><span class="token string">'warning'</span><span class="token punctuation">,</span>
            title<span class="token punctuation">:</span><span class="token string">'去不去由你'</span><span class="token punctuation">,</span>
            message<span class="token punctuation">:</span><span class="token string">'是不是要跟胖哥去红袖招?'</span><span class="token punctuation">,</span>
            buttons<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'我要去'</span><span class="token punctuation">,</span><span class="token string">'不去了'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>result<span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>可以看到回调中<code>result</code>里有一个<code>response</code>这个里会给我们返回按钮的数组下标。</p>
<p>为什么会鼓励使用<code>showMessageBox</code>，因为这样比JS里的<code>alert</code>更加灵活,比如可以设置按钮，可以设置title。</p>
<h2><span id="15electron断网提醒功能制作">15.Electron断网提醒功能制作</span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc351">相关事件</a></p>
<p>其实这个是JavaScript的一种方式进行监听网络状态,监听的事件分别是<code>online</code>和<code>offline</code>。</p>
<ul>
<li>online : 如果链接上网络，就会触发该事件。</li>
<li>offline : 如果突然断网了，就会触发该事件。</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc352">案例演示</a></p>
<p>我们现在要做的就是当断网和重新链接到网络时，都给用户一个提示，方便用户即时得知网络状态。</p>
<p>新建一个文件，比如叫作<code>demo5.html</code>文件，然后编写下面的代码：</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">></span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1.0"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
<span class="token operator">&lt;</span>body<span class="token operator">></span>
    <span class="token operator">&lt;</span>h2<span class="token operator">></span> JSPang<span class="token punctuation">.</span>com  断网提醒测试 <span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>
<span class="token operator">&lt;</span>script<span class="token operator">></span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'online'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'官人，我来了，我们继续哦！'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'offline'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'小女子先行离开一会，请稍等！'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span>
</code></pre>
<p>这样我们就完成了基本的网络情况监控，小伙伴们可以在终端中输入<code>electron .</code> 预览效果。</p>
<h2><span id="16electron底部通知消息的制作">16.Electron底部通知消息的制作</span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc354">window.Notification的属性参数</a></p>
<ul>
<li>title: 通知的标题，可以显示在通知栏上</li>
<li>option: 消息通知的各种属性配置，以对象的形式进行配置。</li>
</ul>
<p>其实如果你想详细学习，完全可以看<code>H5</code>的<code>Notification</code>API进行学习。</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc355">点击按钮提示消息</a></p>
<p>那直接来作一个实例，当我们点击一个按钮时，会自动给我i们弹出提示消息，告诉我们有新的订单。 新建一个<code>demo6.html</code>，然后编写如下代码。</p>
<pre class=" language-js"><code class="language-js"> <span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">></span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1.0"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
<span class="token operator">&lt;</span>body<span class="token operator">></span>
    <span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"notifyBtn"</span><span class="token operator">></span>通知消息<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>
<span class="token operator">&lt;</span>script<span class="token operator">></span>

    <span class="token keyword">var</span> notifyBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'notifyBtn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> option <span class="token operator">=</span> <span class="token punctuation">{</span>
        title<span class="token punctuation">:</span><span class="token string">'小二,来订单了，出来接客了!'</span><span class="token punctuation">,</span>
        body<span class="token punctuation">:</span><span class="token string">'有大官人刚翻了你的牌子'</span><span class="token punctuation">,</span>

    <span class="token punctuation">}</span>
    notifyBtn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">new</span>  <span class="token class-name">window<span class="token punctuation">.</span>Notification</span><span class="token punctuation">(</span>option<span class="token punctuation">.</span>title<span class="token punctuation">,</span>option<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span>
</code></pre>
<p>然后改变一下<code>main.js</code>中的代码，让他渲染<code>demo5.html</code>。</p>
<pre class=" language-js"><code class="language-js">mainWindow<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">"demo6.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>然后在终端中输入<code>electron .</code> 进行查看效果就可以了。</p>
<h2><span id="17electron注册全局快捷键">17.Electron注册全局快捷键</span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc357">注册快捷键</a></p>
<p><code>globalShortcut</code>是主进程中的模块，而且注册的都是全局的快捷键，所以你尽量写在<code>main.js</code>中。打开<code>main.js</code>，然后先引入<code>globalShortcut</code>，代码如下：</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span>  globalShortcut <span class="token operator">=</span> electron<span class="token punctuation">.</span>globalShortcut
</code></pre>
<p>引入后，我们现在的需求是按快捷键<code>ctrl+e</code>键后，打开我的博客<code>https://jspang.com</code>。这时候使用<code>globalShortcut.register</code>方法就可以实现，全部代码如下:</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> electron <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span> 

<span class="token keyword">var</span> app <span class="token operator">=</span> electron<span class="token punctuation">.</span>app   
<span class="token keyword">var</span>  globalShortcut <span class="token operator">=</span> electron<span class="token punctuation">.</span>globalShortcut

<span class="token keyword">var</span> BrowserWindow <span class="token operator">=</span> electron<span class="token punctuation">.</span>BrowserWindow<span class="token punctuation">;</span>  

<span class="token keyword">var</span> mainWindow <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token punctuation">;</span>  
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
    mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>width<span class="token punctuation">:</span><span class="token number">800</span><span class="token punctuation">,</span>height<span class="token punctuation">:</span><span class="token number">600</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  

    globalShortcut<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'ctrl+e'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>

        mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">'https://jspang.com'</span><span class="token punctuation">)</span>  
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    mainWindow<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'test.html'</span><span class="token punctuation">)</span>  

    <span class="token comment" spellcheck="true">//监听关闭事件，把主窗口设置为null</span>
    mainWindow<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'closed'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
        mainWindow <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>这里需要注意的是，注册全局的快捷键必须在<code>ready</code>事件之后，才能注册成功。</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc358">检测快捷键是否注册成功</a></p>
<p>可以使用<code>globalShortcut.isRegistered()</code>方法，来检测快捷键是否注册成功，因为你可能同时打开很多软件，它们已经占用了一些快捷键的组合，所以并不是你100%可以注册成功的。</p>
<pre class=" language-js"><code class="language-js"> <span class="token keyword">let</span> isRegister<span class="token operator">=</span> globalShortcut<span class="token punctuation">.</span><span class="token function">isRegistered</span><span class="token punctuation">(</span><span class="token string">'ctrl+e'</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">'Register Success'</span><span class="token punctuation">:</span><span class="token string">'Register fail'</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'------->'</span><span class="token operator">+</span>isRegister<span class="token punctuation">)</span>
</code></pre>
<p>这样就进行了检测，如果你在实际开发中，可能当有冲突时，软件是支持可以修改快捷键。</p>
<p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc359">注销快捷键</a></p>
<p>因为我们注册的是全局的快捷键，所以当我们关闭软件或者窗口时，记得一定要注销我们的快捷键。防止关闭后打开其他软件和他们的快捷键冲突。</p>
<pre class=" language-js"><code class="language-js">app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'will-quit'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//注销全局快捷键的监听</span>
    globalShortcut<span class="token punctuation">.</span><span class="token function">unregister</span><span class="token punctuation">(</span><span class="token string">'ctrl+e'</span><span class="token punctuation">)</span>
    globalShortcut<span class="token punctuation">.</span><span class="token function">unregisterAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>为了方便学习，给出全部<code>main.js</code>代码:</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> electron <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span> 

<span class="token keyword">var</span> app <span class="token operator">=</span> electron<span class="token punctuation">.</span>app   
<span class="token keyword">var</span>  globalShortcut <span class="token operator">=</span> electron<span class="token punctuation">.</span>globalShortcut

<span class="token keyword">var</span> BrowserWindow <span class="token operator">=</span> electron<span class="token punctuation">.</span>BrowserWindow<span class="token punctuation">;</span>  

<span class="token keyword">var</span> mainWindow <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token punctuation">;</span>  
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
    mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>width<span class="token punctuation">:</span><span class="token number">800</span><span class="token punctuation">,</span>height<span class="token punctuation">:</span><span class="token number">600</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  

    globalShortcut<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'ctrl+e'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>

        mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">'https://jspang.com'</span><span class="token punctuation">)</span>  
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> isRegister<span class="token operator">=</span> globalShortcut<span class="token punctuation">.</span><span class="token function">isRegistered</span><span class="token punctuation">(</span><span class="token string">'ctrl+e'</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">'Register Success'</span><span class="token punctuation">:</span><span class="token string">'Register fail'</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'------->'</span><span class="token operator">+</span>isRegister<span class="token punctuation">)</span>



    mainWindow<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'test.html'</span><span class="token punctuation">)</span>  

    <span class="token comment" spellcheck="true">//监听关闭事件，把主窗口设置为null</span>
    mainWindow<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'closed'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
        mainWindow <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'will-quit'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//注销全局快捷键的监听</span>
    globalShortcut<span class="token punctuation">.</span><span class="token function">unregister</span><span class="token punctuation">(</span><span class="token string">'ctrl+e'</span><span class="token punctuation">)</span>
    globalShortcut<span class="token punctuation">.</span><span class="token function">unregisterAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h2><span id="18electron剪贴板事件的使用">18.Electron剪贴板事件的使用</span></h2><p><a target="_blank" rel="noopener" href="http://www.jspang.com/detailed?id=62#toc361">复制激活码功能实现</a></p>
<p>现在要作一个激活码，然后旁边放一个按钮，点击按钮就可以复制这个激活码，你可以把激活码复制到任何地方。</p>
<p>先新建一个页面<code>demo7.html</code>,然后在里边先写相关的html代码。再里边放入一个文字的激活码，然后放入一个按钮。</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">></span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1.0"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
<span class="token operator">&lt;</span>body<span class="token operator">></span>
    <span class="token operator">&lt;</span>div<span class="token operator">></span>
        激活码：<span class="token operator">&lt;</span>span id<span class="token operator">=</span><span class="token string">"code"</span><span class="token operator">></span>jspangcom1234234242<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span> <span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"btn"</span><span class="token operator">></span>复制激活码<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span>
</code></pre>
<p>然后编写<code>&lt;script&gt;</code>标签，首先分本获取<code>&lt;span&gt;</code>标签的DOM，然后再获取<code>&lt;button&gt;</code>的DOM,然后点击button时，触发事件，把内容复制到剪贴板中。代码如下：</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>clipboard<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> code <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'code'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span>
    btn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        clipboard<span class="token punctuation">.</span><span class="token function">writeText</span><span class="token punctuation">(</span>code<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'复制成功'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre>
<p>这时候就可以进行预览了，如果提示你的<code>require</code>没找到，记得在<code>main.js</code>中加入这句话。</p>
<pre class=" language-js"><code class="language-js">mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    width<span class="token punctuation">:</span><span class="token number">800</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span><span class="token number">600</span><span class="token punctuation">,</span>
    webPreferences<span class="token punctuation">:</span><span class="token punctuation">{</span> nodeIntegration<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre>
<p>这个在前面讲过，这个就是允许你在Electron中使用<code>node</code>，现在就应该可以了。</p>
<h2><span id="19electron打包electron-packager及electron-builder实现">19.electron打包：electron-packager及electron-builder实现</span></h2><h3><span id="electron-packager">electron-packager</span></h3><p>使用命令 <code>npm install electron-packager --save-dev</code> 安装好之后会在<code>package.json</code>中的<code>devDependencies</code>生成代码:</p>
<pre class=" language-json"><code class="language-json"><span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"electron-packager"</span><span class="token operator">:</span> <span class="token string">"^9.1.0"</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>注意：</p>
<p>1、打包时要分清<code>devDependencies</code>与<code>dependencies</code>的区别，文章后会讲。<br>2、package.json 的额外字段 —— productName、author 和 description，虽然这几个字段并不是打包必备的，但它们会在 Windows 的 Squirrel 安装包（用于自动更新）中使用到，所以请读者根据实际情况添加。</p>
</blockquote>
<p>安装好模块之后，就可以对应用进行打包。electron-packager的打包基本命令是：</p>
<pre class=" language-xml"><code class="language-xml">electron-packager <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sourcedir</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appname</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>platform</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>architecture</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>electron</span> <span class="token attr-name">version</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span> <span class="token attr-name">options</span><span class="token punctuation">></span></span>
</code></pre>
<p>参数说明：</p>
<ul>
<li>sourcedir：项目所在路径</li>
<li>appname：应用名称</li>
<li>platform：确定了你要构建哪个平台的应用（Windows、Mac 还是 Linux）</li>
<li>architecture：决定了使用 x86 还是 x64 还是两个架构都用</li>
<li>electron version：electron 的版本</li>
<li>optional options：可选选项</li>
</ul>
<p>为了方便起见，在<code>package.json</code>中添加代码：</p>
<pre class=" language-json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"package"</span><span class="token operator">:</span> <span class="token string">"electron-packager ./ myapp --out ./OutApp --version 1.7.9 --overwrite --icon=./app/img/icon/icon.ico"</span>
  <span class="token punctuation">}</span>
</code></pre>
<p>然后在命令行中执行<code>npm run package</code></p>
<p><img src="https://segmentfault.com/img/bV6y4W?w=843&h=549" alt="命令行输出"></p>
<p>打包成功后，会在OutApp目录（此处的目录是在参数中配置的）下生成.exe，运行该文件，并且没有报错，则说明本次打包成功。</p>
<p><img src="https://segmentfault.com/img/bV6zDS?w=575&h=380" alt="可执行的exe程序"></p>
<blockquote>
<p>特点：</p>
<p>1、支持平台有：Windows (32/64 bit)、OS X (also known as macOS)、Linux (x86/x86_64);<br>2、进行应用更新时，使用electron内置的<code>autoUpdate</code>进行更新<br>3、支持CLI和JS API两种使用方式；</p>
</blockquote>
<h3><span id="electron-builder">electron-builder</span></h3><p>首先来看看什么是electron-builder，来自官方的解释：</p>
<blockquote>
<p>A complete solution to package and build a ready for distribution Electron, Proton Native or Muon app for macOS, Windows and Linux with “auto update” support out of the box.</p>
</blockquote>
<p>简单的说，electron-builder就是有比electron-packager有更丰富的的功能，支持更多的平台，同时也支持了自动更新。除了这几点之外，由electron-builder打出的包更为轻量，并且可以打包出不暴露源码的setup安装程序。考虑到以上几点，我果断选择了electron-builder &amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp （微笑</p>
<p>首先，依旧是安装依赖。<br><em>（这里官方<strong>强烈</strong>推荐使用yarn安装依赖包，但我使用了npm安装的依赖也可以正常打包，所以至于为什么官方强<strong>烈推</strong>荐用yarn，我还没搞懂其原因，还请了解缘由的大佬们赐教）</em></p>
<pre class=" language-livecodeserver"><code class="language-livecodeserver">yarn add electron-builder --save-dev
</code></pre>
<p>在<code>package.json</code>中做如下配置</p>
<pre class=" language-json"><code class="language-json"><span class="token property">"build"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"appId"</span><span class="token operator">:</span> <span class="token string">"com.xxx.app"</span><span class="token punctuation">,</span>
    <span class="token property">"mac"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"target"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"dmg"</span><span class="token punctuation">,</span><span class="token string">"zip"</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"win"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"target"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"nsis"</span><span class="token punctuation">,</span><span class="token string">"zip"</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"dist"</span><span class="token operator">:</span> <span class="token string">"electron-builder --win --x64"</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<p>在命令行中执行<code>npm run dist</code> ，执行结果如下：</p>
<p><img src="https://segmentfault.com/img/bV6AfM?w=843&h=549" alt="使用electron-builder打包"></p>
<p>打包后在dist目录生成如下文件：</p>
<p><img src="https://segmentfault.com/img/bV6Ah7?w=569&h=238" alt="图片描述"></p>
<p>解压zip包或执行setup安装文件，应用启动后且没有报错，则说明本次打包成功。</p>
<blockquote>
<p>特点：</p>
<p>1、electron-builder 可以打包成msi、exe、dmg文件，macOS系统，只能打包dmg文件，window系统才能打包exe，msi文件；<br>2、几乎支持了所有平台的所有格式；<br>3、支持Auto Update；<br>4、支持CLI和JS API两种使用方式；</p>
</blockquote>
<h3><span id="坑">坑</span></h3><p>研究electron打包的过程中踩了不少坑，打包涉及到不少系统级别的问题，从最初的选型到最后的成功打包，看似是个简单的过程，但其中仍有一些需要注意到的地方，我在这里分两点说明：</p>
<h4><span id="devdependencies与dependencies的区别">devDependencies与dependencies的区别</span></h4><p><code>dependencies</code> 表示我们要在生产环境下使用该依赖，<code>devDependencies</code> 则表示我们仅在开发环境使用该依赖。在打包时，一定要分清哪些包属于生产依赖，哪些属于开发依赖，尤其是在项目较大，依赖包较多的情况下。若在生产环境下错应或者少引依赖包，即便是成功打包，但在使用应用程序期间也会报错，导致打包好的程序无法正常运行。</p>
<h4><span id="npm与cnpm的区别">npm与cnpm的区别</span></h4><p>说到<code>npm</code>与<code>cnpm</code>的区别，可能大家都知道，但大家容易忽视的一点，是<code>cnpm</code>装的各种<code>node_module</code>，这种方式下所有的包都是扁平化的安装。一下子<code>node_modules</code>展开后有非常多的文件。导致了在打包的过程中非常慢。但是如果改用<code>npm</code>来安装<code>node_modules</code>的话，所有的包都是树状结构的，层级变深。</p>
<p>由于这个不同，对一些项目比较大的应用，很容易出现打包过程慢且node内存溢出的问题（这也是在解决electron打包过程中困扰我比较久的问题，最后想到了npm与cnpm的这点不同，解决了node打包内存溢出的问题，从打包一次一小时优化到打包一次一分钟，极大的提高了效率）。</p>
<p>所以建议大家在打包前，讲使用<code>cnpm</code>安装的依赖包删除，替换成<code>npm</code>安装的依赖包。</p>
<h2><span id="20electron-系统托盘图标任务通知栏图标右下角图标">20.Electron 系统托盘图标/任务通知栏图标/右下角图标</span></h2><p>打开main.js,添加上应用最小化隐藏到系统托盘功能所需要的代码后是这样的</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment" spellcheck="true">//electron</span>
<span class="token keyword">const</span> electron <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//用一个 Tray 来表示一个图标,这个图标处于正在运行的系统的通知区 ，通常被添加到一个 context menu 上.</span>
<span class="token keyword">const</span> Menu <span class="token operator">=</span> electron<span class="token punctuation">.</span>Menu<span class="token punctuation">;</span>
<span class="token keyword">const</span> Tray <span class="token operator">=</span> electron<span class="token punctuation">.</span>Tray<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//托盘对象</span>
<span class="token keyword">var</span> appTray <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> win<span class="token punctuation">;</span>  
<span class="token keyword">let</span> windowConfig <span class="token operator">=</span> <span class="token punctuation">{</span>  
    width<span class="token punctuation">:</span><span class="token number">800</span><span class="token punctuation">,</span>  
    height<span class="token punctuation">:</span><span class="token number">600</span>  
<span class="token punctuation">}</span><span class="token punctuation">;</span>  
<span class="token keyword">function</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span>windowConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    win<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`file://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.html`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment" spellcheck="true">//开启调试工具  </span>
    win<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">openDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    

    <span class="token comment" spellcheck="true">//系统托盘右键菜单</span>
    <span class="token keyword">var</span> trayMenuTemplate <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            label<span class="token punctuation">:</span> <span class="token string">'设置'</span><span class="token punctuation">,</span>
            click<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//打开相应页面</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            label<span class="token punctuation">:</span> <span class="token string">'帮助'</span><span class="token punctuation">,</span>
            click<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            label<span class="token punctuation">:</span> <span class="token string">'关于'</span><span class="token punctuation">,</span>
            click<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            label<span class="token punctuation">:</span> <span class="token string">'退出'</span><span class="token punctuation">,</span>
             click<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                 app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//因为程序设定关闭为最小化，所以调用两次关闭，防止最大化时一次不能关闭的情况</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
     
    <span class="token comment" spellcheck="true">//系统托盘图标目录</span>
    trayIcon <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//app是选取的目录</span>
     
    appTray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tray</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>trayIcon<span class="token punctuation">,</span> <span class="token string">'app.ico'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//app.ico是app目录下的ico文件</span>
     
    <span class="token comment" spellcheck="true">//图标的上下文菜单</span>
    <span class="token keyword">const</span> contextMenu <span class="token operator">=</span> Menu<span class="token punctuation">.</span><span class="token function">buildFromTemplate</span><span class="token punctuation">(</span>trayMenuTemplate<span class="token punctuation">)</span><span class="token punctuation">;</span>
     
    <span class="token comment" spellcheck="true">//设置此托盘图标的悬停提示内容</span>
    appTray<span class="token punctuation">.</span><span class="token function">setToolTip</span><span class="token punctuation">(</span><span class="token string">'我的托盘图标'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     
    <span class="token comment" spellcheck="true">//设置此图标的上下文菜单</span>
    appTray<span class="token punctuation">.</span><span class="token function">setContextMenu</span><span class="token punctuation">(</span>contextMenu<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//单击右下角小图标显示应用</span>
    appTray<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        win<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    win<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  
        <span class="token comment" spellcheck="true">//回收BrowserWindow对象</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>win<span class="token punctuation">.</span><span class="token function">isMinimized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            win <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            win<span class="token punctuation">.</span><span class="token function">minimize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment" spellcheck="true">/*win.on('resize',() => {  
        win.reload();  
    })*/</span>  

<span class="token punctuation">}</span>  

app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span>createWindow<span class="token punctuation">)</span><span class="token punctuation">;</span>  
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'window-all-closed'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  
    app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'activate'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  
    <span class="token keyword">if</span><span class="token punctuation">(</span>win <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h2><span id="21electron应用任务栏图标闪烁提醒">21.electron应用任务栏图标闪烁提醒</span></h2><p>在 Electron 系统托盘图标/任务通知栏图标/右下角图标 的基础上增加 如下代码即可实现闪烁</p>
<pre class=" language-js"><code class="language-js"> <span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>timer<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>

  timer<span class="token operator">=</span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

      count<span class="token operator">++</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>count<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        appTray<span class="token punctuation">.</span><span class="token function">setImage</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>trayIcon<span class="token punctuation">,</span> <span class="token string">'empty.ico'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>

        appTray<span class="token punctuation">.</span><span class="token function">setImage</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>trayIcon<span class="token punctuation">,</span> <span class="token string">'app.ico'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

      <span class="token punctuation">}</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><span id="扩展"><strong>扩展</strong></span></h2><h3><span id="nativefier">Nativefier</span></h3><h4><span id="简介">简介</span></h4><p>Nativefier 是一个命令行工具，可以以最少的配置轻松地为任何网站创建桌面应用程序，把 Web 页面变成本地应用的命令行工具。通过 Electron + Chromium 把网站包装成本地 .app、.exe 等可执行文件，支持运行在 Windows、macOS 和 Linux 操作系统上。</p>
<p>例如，为 WhatsApp Web 制作可执行文件，只需要运行以下命令：</p>
<pre><code>nativefier &#39;web.whatsapp.com&#39;
</code></pre>
<p><img src="https://mmbiz.qpic.cn/mmbiz_gif/DSU8cv1j3ibQDC7UusanzGG2vnVbAb13WHiawn6MkT66tpDnTHUTpngp6rfVACaBYzDx6Eg1JhEJYAatdjGmxwKg/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1" alt="图片"></p>
<p>项目地址是：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/nativefier/nativefier">https://github.com/nativefier/nativefier</a></p>
<h4><span id="安装">安装</span></h4><ul>
<li><p>macOS 10.9 + Windows + Linux</p>
</li>
<li><p>Node.js &gt;= 12.9 并且 npm &gt;= 6.9</p>
</li>
<li><p>可选依赖</p>
</li>
<li><ul>
<li>使用 ImageMagick 或 GraphicsMagick来转换图标。确保 convert 和 identify 或 gm 在系统路径 $PATH 中。</li>
<li>Wine 在非 Windows 平台下打包 Windows 应用程序。确保wine在系统路径 $PATH 中。</li>
</ul>
</li>
</ul>
<p>然后，使用全局安装 Nativefier：</p>
<pre><code>npm install -g nativefier
</code></pre>
<h4><span id="用法">用法</span></h4><p>要为 medium.com 创建本机桌面应用程序，只需执行以下命令：</p>
<pre><code>nativefier &quot;medium.com&quot;
</code></pre>
<p>Nativefier 将默认设置应用程序名称以及许多其他选项。用户也可以覆盖这些选项。例如，要覆盖名称：</p>
<pre><code>nativefier --name &#39;My Medium App&#39; &#39;medium.com&#39;
</code></pre>
<p>常见的命令行选项有以下这些：</p>
<pre><code>-h, --help                     打印使用信息
-v, --version                  打印 nativefier 版本
-a, --arch &lt;value&gt;             构建时的目标处理器架构，ia32, x64, armv7l, arm64
-c, --conceal                  指定本地化应用程序中的源代码是否一并打包，默认为 false
-e, --electron-version &lt;value&gt; 指定 Electron 版本
-i, --icon &lt;path&gt;              指定应用程序图标
为 Windows 打包时，必须是 .ico 文件的路径。
为 Linux 打包时，必须是 .png 文件的路径。
为 macOS 打包时，如果安装了可选的依赖项，则必须是一个 .icns 或一个 .png 文件。如果有图像转换工具（iconutil，或 ImageMagick 的 conver + identify，或 GraphicsMagick 的 gm），Nativefier 将把 .png 自动转换为 .icns
-n, --name &lt;value&gt;             应用程序的名称，Linux 上使用时不要包含空格
--no-overwrite                 指定目标目录是否不应被覆盖，默认为 false
-p, --platform &lt;value&gt;         执行平台。默认为当前操作系统，也可以指定为 linux，windows，osx或mas
--portable                     使应用程序将用户数据（cookie、缓存等）存储在应用程序文件夹中
--always-on-top                应用程序启动时保持在屏幕最上层
--background-color &lt;string&gt;    指定背景颜色，https://www.electronjs.org/docs/api/browser-window#setting-backgroundcolor
--bookmarks-menu &lt;string&gt;      定义书签菜单的 JSON 文件的路径，如：
&#123;
    &quot;menuLabel&quot;: &quot;&amp;Music&quot;,
    &quot;bookmarks&quot;: [
        &#123;
            &quot;title&quot;: &quot;lofi.cafe&quot;,
            &quot;url&quot;: &quot;https://lofi.cafe/&quot;,
            &quot;type&quot;: &quot;link&quot;,
            &quot;shortcut&quot;: &quot;CmdOrCtrl+1&quot;
        &#125;,
        &#123;
            &quot;title&quot;: &quot;beats to relax/study to&quot;,
            &quot;url&quot;: &quot;https://www.youtube.com/watch?v=5qap5aO4i9A&quot;,
            &quot;type&quot;: &quot;link&quot;,
            &quot;shortcut&quot;: &quot;CmdOrCtrl+2&quot;
        &#125;,
        &#123;
            &quot;type&quot;: &quot;separator&quot;
        &#125;,
        &#123;
            &quot;title&quot;: &quot;RÜFÜS DU SOL Live from Joshua Tree&quot;,
            &quot;type&quot;: &quot;link&quot;,
            &quot;url&quot;: &quot;https://www.youtube.com/watch?v=Zy4KtD98S2c&quot;
        &#125;
    ]
&#125;
--disable-context-menu         禁用上下文菜单
--disable-dev-tools            禁用 Chrome 开发者工具
--full-screen                  使打包的应用程序全屏启动
--height &lt;value&gt;               打包应用的高度，默认为800px
--hide-window-frame            禁用窗口框架和控件
--max-height &lt;value&gt;           打包应用的最大高度，默认为无限制
--max-width &lt;value&gt;            打包应用的最大宽度，默认为无限制
--maximize                     使打包的应用程序最大化启动
--min-height &lt;value&gt;           打包应用的最小高度，默认为0
-m, --show-menu-bar            是否应显示菜单栏
--single-instance              单例，防止应用程序多次运行
--title-bar-style &lt;value&gt;      设置应用标题栏的样式
/* site.css */

/* header is draggable... */
header &#123;
  -webkit-app-region: drag;
&#125;

/* but any buttons inside the header shouldn&#39;t be draggable */
header button &#123;
  -webkit-app-region: no-drag;
&#125;

/* perhaps move some items out of way for the traffic light */
header div:first-child &#123;
  margin-left: 100px;
  margin-top: 25px;
&#125;
--x &lt;value&gt;                    打包应用程序窗口的 X 位置
--y &lt;value&gt;                    打包应用程序窗口的 Y 位置
--zoom &lt;value&gt;                 设置应用程序打开时要使用的默认缩放系数，默认为1.0
--lang &lt;value&gt;                 设置语言，&quot;fr&quot;, &quot;en-US&quot;, &quot;es&quot;等
</code></pre>
<h4><span id="与-docker-一起使用">与 Docker 一起使用</span></h4><p>Nativefier 也可以在 Docker 中使用。</p>
<ul>
<li>从 Docker Hub 拉取最新的稳定镜像：</li>
</ul>
<pre><code>docker pull nativefier/nativefier
</code></pre>
<ul>
<li>或者自己构建镜像：</li>
</ul>
<pre><code>docker build -t local/nativefier .
</code></pre>
<ul>
<li>使用 docker 构建本地应用：</li>
</ul>
<pre><code>docker run --rm -v ~/nativefier-apps:/target/ local/nativefier https://mail.google.com/ /target/
</code></pre>
<h2><span id="书籍">书籍</span></h2><p>electron实战入门进阶与性能优化</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">CANDY</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://codercandy.github.io/2021/12/05/electron-xue-xi-bi-ji/">https://codercandy.github.io/2021/12/05/electron-xue-xi-bi-ji/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">CANDY</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E5%89%8D%E7%AB%AF/">
                                    <span class="chip bg-color">前端</span>
                                </a>
                            
                                <a href="/tags/Electron/">
                                    <span class="chip bg-color">Electron</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    
    <div class="livere-card card" data-aos="fade-up">
    <!-- 来必力City版安装代码 -->
    <div id="lv-container" class="card-content" data-id="city" data-uid="MTAyMC81NDg3My8zMTM0Mg==">
        <script type="text/javascript">
            (function (d, s) {
                let j, e = d.getElementsByTagName(s)[0];
                if (typeof LivereTower === 'function') {
                    return;
                }

                j = d.createElement(s);
                j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                j.async = true;

                e.parentNode.insertBefore(j, e);
            })(document, 'script');
        </script>
        <noscript>为正常使用来必力评论功能请激活JavaScript。</noscript>
    </div>
    <!-- City版安装代码已完成 -->
</div>
    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/12/05/flink-xue-xi-bi-ji/">
                    <div class="card-image">
                        
                        <img src="https://flink.apache.org/img/flink-header-logo.svg" class="responsive-img" alt="Flink学习笔记">
                        
                        <span class="card-title">Flink学习笔记</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-12-05
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%AD%A6%E4%B9%A0/" class="post-category">
                                    学习
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%90%8E%E7%AB%AF/">
                        <span class="chip bg-color">后端</span>
                    </a>
                    
                    <a href="/tags/Flink/">
                        <span class="chip bg-color">Flink</span>
                    </a>
                    
                    <a href="/tags/%E6%B5%81%E8%AE%A1%E7%AE%97/">
                        <span class="chip bg-color">流计算</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/12/05/di-yi-pian-bo-ke/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/13.jpg" class="responsive-img" alt="第一篇博客">
                        
                        <span class="card-title">第一篇博客</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-12-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%94%9F%E6%B4%BB/" class="post-category">
                                    生活
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E9%9A%8F%E7%AC%94/">
                        <span class="chip bg-color">随笔</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('10')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 梓妤<br />'
            + '文章作者: Candy liu<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021-2023</span>
            
            <a href="/about" target="_blank">Candy liu</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2021";
                        var startMonth = "12";
                        var startDate = "5";
                        var startHour = "22";
                        var startMinute = "49";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
<a href="https://gitee.com/CandyLoveYL" class="tooltipped" target="_blank" data-tooltip="访问我的gitee" data-position="top" data-delay="50">
	<i class="fab fa-github"></i>
</a>
<a href="mailto:595487347@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
	<i class="fas fa-envelope-open"></i>
</a>
<a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=595487347" class="tooltipped" target="_blank" data-tooltip="QQ联系我:595487347" data-position="top" data-delay="50">
	<i class="fab fa-qq"></i>
</a>
</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/snow.js"><\/script>');
            }
        </script>
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
